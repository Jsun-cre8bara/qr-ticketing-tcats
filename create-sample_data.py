import pandas as pd
import os

# data 폴더 생성
os.makedirs('data', exist_ok=True)

# 샘플 예매 데이터 (여러 장 예매 포함!)
data = {
    '예매번호': [
        'RES20241101001',
        'RES20241101001',  # 같은 예매번호 - 2장
        'RES20241101001',  # 같은 예매번호 - 3장
        'RES20241101002',
        'RES20241101003',
        'RES20241101003',  # 같은 예매번호 - 2장
        'RES20241101004',
        'RES20241101005',
    ],
    '이름': [
        '홍길동',
        '홍길동',
        '홍길동',
        '김철수',
        '이영희',
        '이영희',
        '박민수',
        '최지은',
    ],
    '전화번호': [
        '010-1234-5678',
        '010-1234-5678',
        '010-1234-5678',
        '010-2345-6789',
        '010-3456-7890',
        '010-3456-7890',
        '010-4567-8901',
        '010-5678-9012',
    ],
    '공연명': [
        '뮤지컬 오페라의 유령',
        '뮤지컬 오페라의 유령',
        '뮤지컬 오페라의 유령',
        '뮤지컬 오페라의 유령',
        '콘서트 BTS',
        '콘서트 BTS',
        '연극 햄릿',
        '뮤지컬 오페라의 유령',
    ],
    '공연일시': [
        '2024-11-15',
        '2024-11-15',
        '2024-11-15',
        '2024-11-15',
        '2024-11-20',
        '2024-11-20',
        '2024-11-25',
        '2024-11-16',
    ],
    '회차': [
        '14:00',
        '14:00',
        '14:00',
        '19:00',
        '18:00',
        '18:00',
        '15:00',
        '14:00',
    ],
    '좌석번호': [
        'A-12',
        'A-13',
        'A-14',
        'B-05',
        '',  # 비지정석
        '',  # 비지정석
        'D-08',
        '',  # 비지정석
    ]
}

df = pd.DataFrame(data)

# Excel 파일로 저장
df.to_excel('data/reservations.xlsx', index=False)

print("✅ 샘플 예매자 명부가 생성되었습니다!")
print(f"📁 위치: data/reservations.xlsx")
print(f"📊 총 {len(df)}개의 좌석 ({df['예매번호'].nunique()}건의 예매)")
print("\n예매 내역:")
print(df.groupby('예매번호').size())
